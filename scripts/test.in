#! /usr/bin/env sh

set -e
set -C
set -u

SRCDIR="@srcdir@"
ROOT="$(cd "$(dirname "$0")" && pwd)"
if test "x${XDG_RUNTIME_DIR}" = "x"
then
    # TODO: Find a fallback
    echo "Don't have a runtime directory" >2
    exit 1
fi

mkdir -p "${XDG_RUNTIME_DIR}/linted/chroot"

exec "${ROOT}/../src/init/linted"\
     --chrootdir="${XDG_RUNTIME_DIR}/linted/chroot"\
     --logger-fstab="${SRCDIR}/src/logger/logger-fstab"\
     --simulator-fstab="${SRCDIR}/src/simulator/simulator-fstab"\
     --gui-fstab="${SRCDIR}/src/gui/gui-fstab"\
     --logger="${ROOT}/../src/logger/logger"\
     --simulator="${ROOT}/../src/simulator/simulator"\
     --gui="${ROOT}/../src/gui/gui" "$@"
