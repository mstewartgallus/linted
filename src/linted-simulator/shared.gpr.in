-- Copyright 2015 Steven Stewart-Gallus
--
-- Licensed under the Apache License, Version 2.0 (the "License");
-- you may not use this file except in compliance with the License.
-- You may obtain a copy of the License at
--
--     http://www.apache.org/licenses/LICENSE-2.0
--
-- Unless required by applicable law or agreed to in writing, software
-- distributed under the License is distributed on an "AS IS" BASIS,
-- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
-- implied.  See the License for the specific language governing
-- permissions and limitations under the License.
abstract project Shared is
  for Source_Files use ();
  for Object_Dir use "@builddir@";

  package Builder is
     for Global_Configuration_Pragmas use "@srcdir@/pragmas.adc";
  end Builder;

  package Compiler is
     for Default_Switches ("Ada") use ("-gnatec=" & Builder'Global_Configuration_Pragmas,
				       "-gnat2012",
				       "-Wall", "-Wextra",
				       "-gnatwa",
				       "-gnatwh", "-gnatw.i", "-gnatw.k", "-gnatw.o",
				       "-gnatwt",
				       "-g",
				       "-E",
				       "-gnateE",
				       "-gnatn",
				       "-O3",
				       "-gno-record-gcc-switches",
				       "-fpic", "-fPIC", "-fpie", "-fPIE",
				       "-fvisibility=hidden",
				       "-Bsymbolic",
				       "-fdata-sections",
				       "-ffunction-sections",
				       "-gnaty3aAbCdefiIklnprsStu",
				       "-fverbose-asm",
				       "-save-temps=cwd",
				       "-gnatD",
				       "-fstack-usage",
				       "-fstack-check",
				       "-ftrapv",
				       "-gnato",
				       "-gnateA",
				       "-gnateV",
				       "-gnatVa",
				       "-gnatE",
				       "-fsanitize=address");
     for Default_Switches ("C") use ("-Wall", "-Wextra",
				     "-g",
				     "-O3",
				     "-fno-working-directory", "-gno-record-gcc-switches",
				     "-fpic", "-fPIC", "-fpie", "-fPIE",
				     "-Bsymbolic",
				     "-fstack-check",
				     "-fdata-sections",
				     "-ffunction-sections",
				     "-fverbose-asm",
				     "-save-temps=cwd",
				     "-fstack-usage");
  end Compiler;

  package Binder is
  end Binder;

  package Linker is
     for Default_Switches ("Ada") use ("-fuse-ld=gold",
				       "-Wl,-z,relro",
				       "-Wl,-z,now",
				       "-Wl,--rosegment",
				       "-pie", "-fpic", "-fPIC", "-fpie", "-fPIE",
				       "-Wl,-O1",
				       "-Wl,-X", "-Wl,--discard-locals",
				       "-Wl,--sort-common",
				       "-Wl,--hash-style=gnu",
				       "-Wl,--as-needed",
				       "-Wl,--gc-sections",
				       "-Wl,-z,combreloc",
				       "-Wl,--icf=safe",
				       "-fsanitize=address",
				       "-fstack-usage");
  end Linker;
end Shared;
